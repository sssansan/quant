## 研报复现5：六：基于GFTD的期指日内程序化交易策略

### 一、策略概述

#### 1.1 GFTD模型

设$c_1,c_2,...,c_n$ 为股指期货日内某一频率下的K线收盘价序列，$h_1,h_2,...,h_n$ 为股指期货日内某一频率下的K线最高价序列，$l_1,l_2,...,l_n$ 为股指期货日内某一频率下的K线最低价序列，$n_1$为模型买入启动或者卖出启动形态形成时价格比较滞后期数，$n_2$为模型买入启动或者卖出启动形态形成的价格关系单向连续个数，$n_3$为模型计数阶段的最终信号发出所需的计数值。
$$
u d_{i}= \begin{cases}1, & \text { if } c_{i}>c_{i-n_{1}} \\ -1, & \text { if } c_{i}<c_{i-n_{1}} \\ 0, & \text { else }\end{cases}
$$
其中，$ud_i$为第i根K线价格关系的比较结果，计算公式如上。

模型信号计算步骤：

（1）计算 $ud_i\quad i=1,2,...,n$

（2）对$ud_i$ 进行累加计算，且当其值与上一个值不等时，停止本次累加。

（3）当$ud_i$累加计算结果为$n_2$ 时为一个卖出启动的形成，当计算结果为 $-n_2$ 时为一个买入启动的形成。 

（4）于买入启动形成的随后1根K线位置开始买入计数，在某一个K线上同时满足如下三个条件时买入计数累加1，当计数累加至$n_3$发出买入信号。
A.	收盘价大于或等于之前第2根K线最高价；
B.	最高价大于之前第1根K线的最高价；
C.	收盘价大于之前第1个计数的收盘价。
（5）于卖出启动形成的随后1根K线位置开始卖出计数，在某一个K线上同时满足如下三个条件时卖出计数累加1，当计数累加至$n_3$发出卖出信号。
A.	收盘价小于或等于之前第2根K线最低价；
B.	最低价小于之前第1根K线的最低价；
C.	收盘价小于之前第1个计数的收盘价。
（6）当形成一组新的买入启动时，取消上一组未最终形成买入信号的买入计数。 
（7）当形成一组新的卖出启动时，取消上一组未最终形成卖出信号的卖出计数。

###### 图1：判断交易流程图

![image-20220512131154441](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220512131154441.png)

#### 1.2 GFTD模型的止损方式

在每次形成买入/卖出信号后，将相应计数的形成周期内市场的最高点或者最低点设成止损点，例如当期形成买入信号，那么取买入计数过程中的市场最低点为止损点，反之，当期形成卖出信号，那么取卖出计数过程中的市场最高点为止损点，在市场未触及止损点之前，一直持有头寸，直到出现反向信号或者触发止损为止。

为了避免持仓隔夜风险，设置收盘15点强制平仓。

这里买入启动和卖出启动是分别计算的，形成买入计数和卖出计数互不影响，即使买入计数=n3形成了买入信号，卖出计数不归零，仍继续计算，如果卖出计数=n3，则会形成反向信号。

### 二、实证分析

**（1）数据选取**：

本实证选取沪深300股指期货合约加权平均（IF8888）在2010年4月16日到2012年7月6日的1分钟K线为样本集。评价指标考察：累计收益，多仓空仓胜率、持有期、最大回撤、年化收益、年华标准差、夏普比率等。

**（2）交易假设**：

设置单边冲击成本0.4个指数点：

![image-20220511165228032](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511165228032.png)

此外单边手续费万分之零点五，开仓价格为信号发生后第一根K线的开盘价格。

加入止损机制，触及止损机制时，平仓止损，再根据之后的交易信号开仓，若当日未发生止损，则收盘15:00强制平仓。

根据研报选取参数 $n_1=5,n_2=3,n_3=6$

**（3）回测结果：**

```
累计收益       205.01%
多仓次数           871
多仓成功次数         284
多仓胜率        32.61%
多仓平均持有期      36.87
空仓次数          1040
空仓成功次数         413
空仓胜率        39.71%
空仓平均持有期      46.41
周期胜率        49.88%
最大回撤         6.28%
年化收益/最大回撤    10.36
年化收益        65.08%
年化标准差       14.27%
年化夏普          4.56
```

###### 图2：指数期货与收益（红线为收益，蓝线为指数期货）

![image-20220512131927274](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220512131927274.png)

###### 图3：收益

![image-20220512131949211](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220512131949211.png)

### 三、参数选取

对不同的$n_1,n_2,n_3$ 进行收益率计算，其中$n_1$取值1-10，$n_2$取值1-10， $n_3$取值5,6,7，则有如下收益率：

###### 表1：不同参数下的累计收益率（取top10）

![image-20220512132234760](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220512132234760.png)

三个参数的平均值为5.8，3.1, 6.2，虽然5,3,6不是最佳收益率取值，但top10组合的平均值接近默认参数取值。

