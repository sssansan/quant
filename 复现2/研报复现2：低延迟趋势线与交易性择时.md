## 研报复现2：低延迟趋势线与交易性择时

### 一、策略概述

#### 1.传统均线与LLT低延迟趋势线

趋势策略中最常见的是利用移动平均线。
$$
M A(n)=\frac{1}{n} \sum_{i=0}^{n-1} \operatorname{price}(T-i)
$$
price取收盘价，MA(n)为T日的n日均线指标，采用选取不同的n，平滑性会不同，当n逐渐增大时，平滑线会更好，但延迟也会增加。

为了克服MA指标的缺点，采用信号处理中时域频域转换后，过滤指数或者价格信号的高频部分，保留低频部分，再将低频部分转换回时域。考虑一阶线性滤波器指数平均线EMA，其公式为：
$$
E M A(T)=\alpha *price (T)+(1-\alpha) * E M A(T-1)
$$
$\alpha$ 介于0和1之间，计算采用$\alpha = \frac{2}{d+1}$ , $E M A(1)= price (1)$。时频变化采用Z变化，其为离散时间信号的复频域分析		
$$
F(z)=\sum_{k=-\infty}^{\infty} f(k) z^{-k}
$$
定义传输函数为输出信号Z变换和输入信号Z变换的比值，将指数或者价格序列看做输入信号，均线指标看做输出信号，则EMA均线的传输函数为
$$
H(z)=\frac{EMA(z)}{price(z)}
$$
利用Z变换的线性性质和时位移性质，通过数学推导，可以求出EMA均线的传输函数为
$$
H_1(z)=\frac{\alpha}{1-(1-\alpha)*z^{-1}}
$$
当$z^{-1}$ 取值为1时，传输函数为 1，取值为-1时，传输函数为$\frac{\alpha}{2-\alpha}$ ，使得原输入信号的高频分量被大幅削减，为了进一步削减高频分量，采用修正EMA指标
$$
E M A^{\prime}(T)=\alpha * \frac{\operatorname{price}(T)+\operatorname{price}(T-1)}{2}+(1-\alpha) * E M A^{\prime}(T-1)
$$
类似可得传输函数
$$
H_2(z)=\frac{\alpha*(1+z^{-1})/2}{1-(1-\alpha)*z^{-1}}
$$
为了保留高频分量，可以从全部输入信号中减去低频分量，构造高通滤波器。


$$
H_3(z)=1-H_2(z) = \frac{(1-\alpha/2)*(1-z^{-1})}{1-(1-\alpha)*z^{-1}}
$$
为了尽量保留所需信号，选择合适阶数的滤波器，这里选择二阶串联过滤器，即传输函数为：
$$
H_4(z)=H_3(z)*H_3(z) = \frac{(1-\alpha/2)^2*(1-2z^{-1}+z^{-2})}{1-2(1-\alpha)z^{-1}+(1-\alpha)^2z^{-2}}
$$
为了得到所需的低通滤波系统，再用$1-H_4(z)$:
$$
H_{5}(z)=1-H_{4}(z)=\frac{\left(\alpha-\alpha^{2} / 4\right)+\left(\alpha^{2} / 2\right) z^{-1}-\left(\alpha-3 \alpha^{2} / 4\right) z^{-2}}{1-2(1-\alpha) z^{-1}+(1-\alpha)^{2} z^{-2}}
$$

###### 图1：上证指数各类型趋势线比较（2012-12-26到2013-3-27）

![image-20220511151439363](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511151439363.png)

可以看出，LLT的延迟更低。

###### 图2：上证指数趋势线比较

![image-20220511153020050](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511153020050.png)

#### 2.择时策略

按照趋势线的方向进行择时，即通过切向方向，由于LLT在一定参数条件下有较好的平滑性，可以将该趋势线近似看做一条处处可微的曲线，通过向前差分计算，可以求出在每个交易日阶数后得到的LLT趋势线在该点切线的斜率k。当K>0时，做多，k<0时，做空，k=0时，不操作。

###### 图3：判断交易流程图

![image-20220511152754446](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511152754446.png)





### 二、实证分析

#### 1.实证说明

**（1）数据选取**

本实证选取上证指数2005年9月6日到2013年6月28日的历史日线数据。评价指标考察：累计收益，多仓空仓胜率、持有期、最大回撤、年化收益、年华标准差、夏普比率等。

**（2）回测结果：**

##### 1.1 普通MA均线择时

选取MA30， 依据上述策略进行回测

```
累计收益       322.36%
多仓次数            57
多仓成功次数          18
多仓胜率        31.58%
多仓平均持有期      16.63
空仓次数            57
空仓成功次数          20
空仓胜率        35.09%
空仓平均持有期      13.86
周期胜率        54.80%
最大回撤        41.70%
年化收益/最大回撤     0.49
年化收益        20.25%
年化标准差       27.50%
年化夏普          0.74
```

交易累计收益图示：

###### 图4：指数期货与收益（红线为收益，蓝线为指数期货）![image-20220511153939552](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511153939552.png)

###### 图5：收益

![image-20220511154004208](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511154004208.png)



##### 1.2 LLT低延迟趋势线择时

选取$\alpha=0.05$，采用上述策略回测

```
累计收益       540.08%
多仓次数            51
多仓成功次数          19
多仓胜率        37.25%
多仓平均持有期      18.75
空仓次数            50
空仓成功次数          17
空仓胜率        34.00%
空仓平均持有期      16.44
周期胜率        55.55%
最大回撤        40.02%
年化收益/最大回撤     0.67
年化收益        26.82%
年化标准差       27.56%
年化夏普          0.97
```

交易累计收益图示：

###### 图6：指数期货与收益（红线为收益，蓝线为指数期货）

![image-20220511154149659](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511154149659.png)

###### 图7：收益

![image-20220511154216280](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511154216280.png)

可以看出LLT策略相较于均线策略效果较好。

##### 1.3 考虑不同 $\alpha$ 取值下的LLT策略

由于LLT趋势线中存在参数 $\alpha$ ，故对不同 $\alpha$ 下的收益进行比较，选取d为20,30,40,50,60,70,80,90，分别计算收益。

###### 表1：不同d取值下的累计收益

![image-20220511155021137](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511155021137.png)

###### 图8：d的不同取值下收益（20,30,60,90）

![image-20220511155152124](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511155152124.png)

###### 图9：d的不同取值下收益柱状图

![image-20220511155227465](C:\Users\三三\AppData\Roaming\Typora\typora-user-images\image-20220511155227465.png)

从累计收益分布图中可以看出，在d=30时，收益较高，且较为稳定。